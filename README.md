# iOS_AutoBuild
iOSè‡ªåŠ¨æ‰“åŒ…1

# iOS è‡ªåŠ¨æ‰“åŒ…

ä½¿ç”¨è„šæœ¬å®ç°è‡ªåŠ¨æ‰“åŒ…ï¼Œç½‘ä¸Šæœäº†å¥½å¤šï¼Œä½†æ˜¯å¶æ¯”è¾ƒç¬¨ï¼Œä¸€ç›´å‘ç°ä¸çŸ¥é“æ€ä¹ˆä½¿ç”¨ï¼Œçœ‹äº†å¥½ä¹…ï¼Œ
ç»ˆäºæ”¹äº†ä¸ªå¯ä»¥ä½¿ç”¨çš„ï¼Œä½†æ˜¯æœ€åå‘ç°ä¸èƒ½ç”¨xcrunå¯¼å‡ºï¼›å®å®å¿ƒé‡Œè‹¦ï¼Œä½†å®å®ä¸è¯´ğŸ˜‚ï¼›æ¥ç€æ”¹ï¼Œæœ€åç»ˆäºè¢«æˆ‘æ£é¼“æˆåŠŸäº†ï¼Œåˆ†äº«ç»™å¤§å®¶ä¸€ä¸‹

Note: åªæ˜¯ç®€å•çš„åŸºç¡€ç‰ˆæœ¬çš„ï¼Œè¿™ä¸ªæ”¯æŒçš„æ˜¯æ²¡æœ‰ä½¿ç”¨Cocoapodsçš„å·¥ç¨‹ï¼Œï¼Œè„šæœ¬è§é™„ä»¶ï¼›å¦‚æœæ˜¯ä½¿ç”¨Cocoapodså·¥ç¨‹çš„ï¼Œå¯ä»¥ç¨å¾®ä¿®æ”¹ä¸€ä¸‹ï¼Œé¼“åŠ±å¤§å®¶è‡ªå·±è¯•è¯•ï¼Œè¯•å¥½äº†é¡ºä¾¿åˆ†äº«ç»™æˆ‘ï¼ŒğŸ˜‰

ä½¿ç”¨æ–¹æ³•ï¼š
> iOSè‡ªåŠ¨æ‰“åŒ…-shçš„ä½¿ç”¨ï¼šä¸‹è½½å‹ç¼©åŒ…åï¼Œè§£å‹ï¼Œé‡Œé¢æœ‰åç¼€ä¸º.shçš„æ–‡ä»¶å’Œ.plistçš„æ–‡ä»¶ï¼Œå°†è¿™ä¸¤ä¸ªæ–‡ä»¶æ”¾åˆ°  
.xcodeprojæ‰€åœ¨çš„æ–‡ä»¶å¤¹ä¸‹ï¼Œç„¶åProjectNameå’ŒSchemeNameï¼Œæ‰“å¼€terminalï¼Œè¿è¡Œè¿™ä¸ª.shæ–‡ä»¶å³å¯ã€‚


ç„¶åæ¥è¯´ä¸€ä¸‹è°ƒè¯•ä¸­é‡åˆ°çš„é—®é¢˜ï¼š
1. æ–‡ä»¶è·¯å¾„çš„é—®é¢˜
2. Schemeçš„é—®é¢˜ï¼Œæˆ‘ä¸çŸ¥é“è‡ªå·±çš„shemeæ˜¯ä»€ä¹ˆï¼Ÿæˆ–è€…æˆ‘çš„shemeæ˜æ˜å°±æ˜¯è¿™ä¸ªä½†æ˜¯æç¤ºæˆ‘æ‰¾ä¸åˆ°
3. è„šæœ¬è¿è¡Œå®Œï¼Œå‘ç°æ‰€æœ‰çš„æ–‡ä»¶éƒ½å˜æˆModifiedçŠ¶æ€ï¼Œæ•´ä¸ªäººé¡¿æ—¶å°±ä¸å¥½äº†ã€‚ã€‚ã€‚

### é—®é¢˜ä¸€ï¼šè·¯å¾„çš„é—®é¢˜
å› ä¸ºæ˜¯shellè„šæœ¬ï¼Œå¶ä¼šçš„æœ¬æ¥å°±ä¸å¤šï¼Œå‘¨äº”é‚£å¤©æ™ºå•†çˆ†è¡¨ï¼Œå±…ç„¶å•ƒæ‡‚äº†å…¶ä¸­å‡ å¥ï¼Œç„¶åè¿˜çŸ¥é“å»æ‰¾åº¦å¨˜ï¼Œæ‰€ä»¥è¢«æˆ‘æ”¹æˆåŠŸäº†ï¼Œ
è¿™ä¸ªè„šæœ¬è·¯å¾„è¢«è®¾ç½®ä¸º.xcodeprojæ‰€åœ¨çš„æ–‡ä»¶å¤¹ï¼Œ  
æ‰“åŒ…çš„.xcarchiveæ–‡ä»¶æ”¾åœ¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹çš„.buildæ–‡ä»¶å¤¹ä¸‹ï¼Œ  
å¯¼å‡ºçš„ipaæ–‡ä»¶åœ¨æ¡Œé¢

### é—®é¢˜äºŒï¼šSchemeçš„é—®é¢˜
ä¸çŸ¥é“è‡ªå·±çš„Schemeæ˜¯ä»€ä¹ˆçš„ï¼Œå¯ä»¥å»Product->Scheme->Edit Schemeä¸‹æŸ¥çœ‹  
![Scheme æŸ¥çœ‹1](https://ooo.0o0.ooo/2017/02/20/58aa93bb6da09.png)

æˆ–è€…ç›´æ¥è¿è¡Œè„šæœ¬ä¼šæ‰“å°å‡ºæ¥  
![Scheme æŸ¥çœ‹2](https://ooo.0o0.ooo/2017/02/20/58aa955cbc561.png)


å†™äº†è‡ªå·±çš„Schemeä½†æ˜¯è¿è¡Œè„šæœ¬åæŠ¥è¿™ä¸ªé”™çš„  
![No Schemes img](https://ooo.0o0.ooo/2017/02/20/58aa9312cd66a.png)

è¦æ³¨æ„ä¸€ä¸‹Edit Schemeç•Œé¢çš„sharedè¦å‹¾é€‰  
![Fixed No Schemes](https://ooo.0o0.ooo/2017/02/20/58aa965241867.png)


### è„šæœ¬è¿è¡Œå®Œï¼Œæ‰€æœ‰æ–‡ä»¶å˜ä¸ºModifiedçŠ¶æ€
ä½¿ç”¨git diffæŸ¥çœ‹äº†ä¹‹åï¼Œå‘ç°æ˜¯filemodeçš„å˜åŒ–
> æ–‡ä»¶chmodåå…¶æ–‡ä»¶æŸäº›ä½å‘ç”Ÿäº†å˜åŒ–ï¼Œå¦‚æœä¸¥æ ¼æ¯”è¾ƒåŸæ–‡ä»¶å’Œchmodåçš„æ–‡ä»¶ï¼Œä¸¤è€…æ˜¯ä¸ä¸€æ ·çš„ï¼Œä½†æ˜¯æºä»£ç é€šå¸¸åªå…³å¿ƒæ–‡æœ¬å†…å®¹ï¼Œå› æ­¤chmodäº§ç”Ÿçš„å˜åŒ–åº”è¯¥å¿½ç•¥

ä¸Šé¢çš„æ˜¯æ‰¾åº¦å¨˜ä¹‹åï¼Œæ‰¾åˆ°çš„åšå®¢é‡Œä»‹ç»çš„ï¼Œè¯·åŸè°…ï¼Œå¿˜è®°å½“æ—¶æ€ä¹ˆæœçš„äº†ï¼Œæ‰€æœ‰æ‰¾ä¸åˆ°å‡ºå¤„ï¼Œæ–‡å­—æ˜¯å½“æ—¶æˆªå›¾ã€‚ã€‚ã€‚ã€‚ã€‚
è¾“å…¥ `git config core.filemode false`ï¼Œä¹‹åå°±å¥½äº†

## ä»£ç åˆ†æ
1. å˜é‡å£°æ˜
![Implement Var](https://ooo.0o0.ooo/2017/02/20/58aa99c4776a9.png)
project_path æ˜¯è·å–æ­¤è„šæœ¬æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ï¼Œç™¾åº¦æœå‡ºæ¥çš„[Linux-è·å–å½“å‰æ­£åœ¨æ‰§è¡Œè„šæœ¬çš„ç»å¯¹è·¯å¾„](http://www.cnblogs.com/JohnABC/p/5855535.html)  
project_name æ˜¯.xcodeprojå‰é¢çš„æ–‡å­—  
scheme_name æ˜¯å‰é¢è¯´çš„é‚£ä¸ª  
build_path æ˜¯å½“å‰è·¯å¾„ä¸‹buildæ–‡ä»¶å¤¹  
exportOptionsPlistPath æ˜¯plistæ–‡ä»¶çš„è·¯å¾„  
exportFilePath æ˜¯å¯¼å‡º.ipaåŒ…çš„è·¯å¾„

2. æ‰“å°schemeã€æ¸…ç†å·¥ç¨‹ã€ç¼–è¯‘å·¥ç¨‹ã€æ‰“åŒ…
![Run Code](https://ooo.0o0.ooo/2017/02/20/58aa9b9f7b738.png)
æ‰“å°schemeï¼Œå¦‚æœä¸çŸ¥é“æ€ä¹ˆè·å–scheme_nameï¼Œå¯ä»¥å…ˆå¡«ä¸Šä¸Šé¢çš„project_nameï¼Œæ³¨é‡Šæ‰ä¸‹é¢æ‰€æœ‰çš„ä»£ç ï¼Œè¿è¡Œï¼Œå°±ä¼šæ‰“å°å‡ºæ¥å½“å‰projectçš„scheme  
æ¸…ç†å·¥ç¨‹ï¼Œç¼–è¯‘ä¹‹å‰å…ˆcleanä¸€ä¸‹ã€‚ã€‚ã€‚ã€‚  
ç¼–è¯‘å·¥ç¨‹ï¼Œç¼–è¯‘å¹¶ç”Ÿæˆ.xcarchiveæ–‡ä»¶ï¼Œæ”¾åœ¨build_pathä¸‹ï¼Œåå­—æ˜¯project_name.xcarchiveï¼Œè¿™ä¸€æ­¥æœ€ä¸ºè€—æ—¶  
æ‰“åŒ…ï¼Œå°†ç”Ÿæˆçš„.xcarchiveæ–‡ä»¶å¯¼å‡º.ipaåŒ…åˆ°æ¡Œé¢  

> è¿™é‡Œé¢æ¯ä¸€æ­¥éƒ½å¯ä»¥å•ç‹¬æ‰§è¡Œï¼Œä¾‹å¦‚æƒ³è·å–shcemeå°±æ³¨é‡Šæ‰å…¶ä»–å‡ æ®µä»£ç ï¼›æƒ³æµ‹è¯•ç¼–è¯‘é€šè¿‡æ²¡ï¼Œå°±åªä¿ç•™æ¸…ç†ã€ç¼–è¯‘è¿™æ®µï¼›ç¼–è¯‘æˆåŠŸï¼Œå¯¼å‡ºå¤±è´¥ï¼Œå°±åªä¿ç•™å¯¼å‡ºè¿™ä¸€æ®µï¼Œä¿®æ”¹æµ‹è¯•

3. åˆ¤æ–­å¯¼å‡ºæ˜¯å¦æˆåŠŸ
![Is Export Success](https://ooo.0o0.ooo/2017/02/20/58aa9d3e2ac48.png)
åˆ¤æ–­æ¡Œé¢æ˜¯å¦æœ‰scheme_name.ipaæ–‡ä»¶ï¼Œæœ‰çš„è¯ï¼Œå°±è§†ä¸ºæ‰“åŒ…æˆåŠŸï¼Œæ‰“å¼€è¿™ä¸ªæ–‡ä»¶å¤¹ï¼›

## åè®°
a. å¦‚æœæ˜¯workspaceå·¥ç¨‹ï¼Œå¯æŒ‰ç…§è¿™é‡Œè¿™ä¸ªé“¾æ¥ï¼Œä¿®æ”¹æ¸…ç†å·¥ç¨‹ã€ç¼–è¯‘å·¥ç¨‹ã€æ‰“åŒ…è¿™å‡ æ­¥  

[xcodebuild-developer.apple](https://developer.apple.com/legacy/library/documentation/Darwin/Reference/ManPages/man1/xcodebuild.1.html/man.1.html)  

è¿™å°±æ˜¯ä¸Šé¢é“¾æ¥é‡Œçš„å†…å®¹ï¼Œxcodebuildçš„ä½¿ç”¨éƒ½åœ¨è¿™é‡Œ
![xcodebuild](https://ooo.0o0.ooo/2017/02/20/58aa9eb88e322.png)

b. .plistæ–‡ä»¶é‡Œçš„å†…å®¹å¯å‚ç…§è¿™ä¸ªé“¾æ¥ï¼Œéœ€è¦ç¿»å¢™
[xcodebuild's new exportOptionsPlist flag](http://www.matrixprojects.net/p/xcodebuild-export-options-plist/#tldr)
